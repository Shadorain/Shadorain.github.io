<!DOCTYPE html> <!-- theme: jekyll-rtd-theme, based on v0.1.8 --> <html class="writer-html5" lang="en-US"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> <title>Crackme - Guild Hall Adventure Ch.2 · Shadorealm</title> <!-- meta --> <meta name="description" content="Guild Hall Adventure Ch. 2 - Crackme Writeup Author: ker2x Level: 2.0 Quality: 4.0 Platform: Unix/Linux Language: C/C++ This crackme has been provi..."> <meta name="author" content="Shadorain"> <meta name="revised" content="[commit]"> <meta name="generator" content="jekyll-rtd-theme v0.1.8"> <!-- custom meta --> <!-- og --> <meta property="og:title" content="Crackme - Guild Hall Adventure Ch.2 · Shadorealm"> <meta property="og:description" content="Guild Hall Adventure Ch. 2 - Crackme Writeup Author: ker2x Level: 2.0 Quality: 4.0 Platform: Unix/Linux Language: C/C++ This crackme has been provi..."> <meta property="og:locale" content="en-US"> <meta property="og:url" content="http://localhost:4000/blog/Security/Reversing/Crackme_gha2"> <meta property="og:type" content="article"> <meta property="article:author" content="Shadorain"> <meta property="article:modified_time" content="2021-05-04T15:58:15-04:00"> <!-- schema --> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Article", "name": "Crackme - Guild Hall Adventure Ch.2 · Shadorealm", "author": "Shadorain", "url": "http://localhost:4000/blog/Security/Reversing/Crackme_gha2", "dateModified": "2021-05-04T15:58:15-04:00" } </script> <!-- link --> <link rel="prev" href="http://localhost:4000/blog/Security/Reversing/Crackme_gha1"><link rel="canonical" href="http://localhost:4000/blog/Security/Reversing/Crackme_gha2"> <!-- theme --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@0.1.8/assets/css/theme.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@0.1.8/assets/css/rougify/github.css"> <style>.wy-embed-wrap{width:100%;padding:1em 1.5em;font-size:14px;line-height:20px}.wy-embed-wrap .wy-embed{text-align:center;padding:1em;color:#c2c2c2;background:#4e4b4b;border:1px solid #a0a0a0;border-radius:5px}.wy-embed-wrap .wy-embed a{color:#e6e6e6}.wy-embed-wrap .wy-embed img{max-width:100%}p{font-size:15px}footer p{font-size:14px;text-align:center}.fa-angle-double-right{font-size:13px}.rst-versions.shift-up{overflow-y:auto}.wy-nav-side{padding-bottom:3em}.wy-nav-top a{margin-left:-30px}.rst-content ol,.rst-content ul{overflow-x:auto}.rst-content a code.literal{color:#2980b9}.rst-content code,.rst-content div[class^=highlight] pre,.rst-content pre{font-family:monospace;font-size:12px}.copyright-rtd{display:none}.highlighted-box{border:1px solid #f1c40f}#search-results li:last-child{border-bottom:0;padding-bottom:0}@media screen and (max-width: 768px){.wy-nav-content-wrap .wy-nav-content{padding:1em}}@media screen and (max-width: 480px){.wy-breadcrumbs li.wy-breadcrumbs-aside{display:initial}}*{scrollbar-color:#202324 #454a4d}body{color:#f0deff}.wy-nav-content-wrap{background:#000000 !important}.rst-content .toctree-wrapper>p.caption,h1,h2,h3,h4,h5,h6,legend{color:#ff4879}.wy-body-for-nav{background:#0e0e11}.wy-nav-content{background:#101019;max-width:1200px}.wy-nav-side{background:#191926;padding-bottom:0px important}.wy-nav-top{background:#5834eb}.wy-nav-top a{color:#ff2e66}.wy-side-nav-search{background:#5834eb}a{color:#8897F4}a:link{color:#8897F4}a:visited{color:#8897F4}a:hover{color:#36dbd0}.rst-content table.docutils:not(.field-list) tr:nth-child(2n-1) td,.wy-table-backed,.wy-table-odd td,.wy-table-striped tr:nth-child(2n-1) td{color:#E9729D;background:#212133}.rst-content table.docutils,.wy-table-bordered-all{border:1px solid #bd93f9}.rst-content table.docutils td,.wy-table-bordered-all td{border:1px solid #bd93f9}.rst-content div[class^="highlight"],.rst-content pre.literal-block{border:1px solid #bd93f9}hr{border-color:#bd93f9}.rst-content blockquote{color:#c5b6e7;border-left-color:#2f2f4a;padding:0 0 0 1em;border-left:.25em solid #2f2f4a;background:rgba(0,0,0,0.3);background:linear-gradient(90deg, rgba(0,0,0,0.7021009087) 0%, rgba(0,0,0,0.5032213569) 70%, transparent 100%);margin-left:12px}a.icon.icon-home{color:#f7edff;font-size:110%}.btn:focus{background:#2f2f4a}.btn-neutral{background-color:#2f2f4a !important;color:#E9729D !important}.btn-neutral:visited{background-color:#2f2f4a !important;color:#E9729D !important}.btn-neutral:hover{background-color:#39395a !important;font-weight:bold;color:#f09ebc}.btn{background-color:#2f2f4a;color:#E9729D;border-radius:1px;box-shadow:rgba(47,47,74,0.5) 0px 4px 12px 0px;border:1px solid rgba(0,0,0,0.1);padding-bottom:6px}.btn:visited{background-color:#2f2f4a;color:#E9729D;border-radius:1px;box-shadow:unset;border:1px solid rgba(0,0,0,0.1)}.btn:hover{background-color:#39395a;font-weight:bold;color:#f09ebc;border-radius:1px;box-shadow:rgba(47,47,74,0.5) 0px 2px 6px 0px;border:1px solid rgba(0,0,0,0.1)}.wy-menu-vertical li span.toctree-expand{color:#ff79c6}.wy-menu-vertical a:active{background:linear-gradient(90deg, rgba(0,0,0,0.7021009087) 0%, rgba(0,0,0,0.5032213569) 70%, transparent 100%)}.wy-menu-vertical li.current>a span.toctree-expand,.wy-menu-vertical li.on a span.toctree-expand{color:#bfaee4;line-height:1.2}.wy-menu-vertical li span.toctree-expand:hover{color:#943d84}.wy-menu-vertical header,.wy-menu-vertical p.caption{color:#f0deff;font-size:90%}a.reference.internal{font-size:95%}a.reference.internal:hover{color:#7658ee;font-weight:bold}.fa-plus-square-o::before,.wy-menu-vertical li span.toctree-expand::before{content:""}.fa-minus-square-o::before,.wy-menu-vertical li.current>a span.toctree-expand::before,.wy-menu-vertical li.on a span.toctree-expand::before{content:""}.wy-menu-vertical a:hover{background:rgba(0,0,0,0.3);background:linear-gradient(90deg, rgba(0,0,0,0.7021009087) 0%, rgba(0,0,0,0.5032213569) 70%, transparent 100%)}.wy-menu-vertical a:hover span.toctree-expand{color:#55a5d9}.wy-menu-vertical li.toctree-l1.current>a{color:#ff79c6;background:#151520;border:unset}.wy-menu-vertical li.toctree-l1.current>a:hover .toctree-expand{color:#943d84}.wy-menu-vertical li.toctree-l2.current>a,.wy-menu-vertical li.toctree-l2.current>a{color:#55a5d9;background:#13131d;border:unset}.wy-menu-vertical li.toctree-l2.current li.toctree-l3>a{color:#a888f4;background:#0f0f17;border:unset}.wy-menu-vertical li.current a{color:#bd93f9;background:#13131d;border:unset}.wy-menu-vertical li.current a:hover{color:#36dbd0;background:#0f0f17;border:unset}.wy-menu-vertical li.toctree-l2 a:hover span.toctree-expand,.wy-menu-vertical li.toctree-l3 a:hover span.toctree-expand,.wy-menu-vertical li.toctree-l4 a:hover span.toctree-expand,.wy-menu-vertical li.toctree-l5 a:hover span.toctree-expand,.wy-menu-vertical li.toctree-l6 a:hover span.toctree-expand,.wy-menu-vertical li.toctree-l7 a:hover span.toctree-expand,.wy-menu-vertical li.toctree-l8 a:hover span.toctree-expand,.wy-menu-vertical li.toctree-l9 a:hover span.toctree-expand,.wy-menu-vertical li.toctree-l10 a:hover span.toctree-expand{color:#943d84}.wy-menu-vertical li.toctree-l2 span.toctree-expand{color:#ff79c6}.wy-side-nav-search input[type="text"]{border-color:#39395a;border-radius:2px;background:#2f2f4a;box-shadow:unset;color:#bfaee4}.rst-content .highlighted{box-shadow:0 0 0 2px #ff79c6;background:#ff79c6;color:#bfaee4}html.writer-html4 .rst-content dl:not(.docutils)>dt,html.writer-html5 .rst-content dl[class]:not(.option-list):not(.field-list):not(.footnote):not(.glossary):not(.simple)>dt{color:#ec88ac;background:#32324d;border-top:3px solid #8897F4}.rst-content .admonition-todo p:last-child,.rst-content .admonition p:last-child,.rst-content .attention p:last-child,.rst-content .caution p:last-child,.rst-content .danger p:last-child,.rst-content .error p:last-child,.rst-content .hint p:last-child,.rst-content .important p:last-child,.rst-content .note p:last-child,.rst-content .seealso p:last-child,.rst-content .tip p:last-child,.rst-content .warning p:last-child,.wy-alert p:last-child{color:#101019}.rst-content code{box-shadow:0.75px 0.75px 0.75px 0.75px #1b1b29,0.75px 0.75px 0.75px 0.75px rgba(0,0,0,0.1);border-radius:4px;background:#292941;border:1px solid #292941}.rst-content code.literal,.rst-content tt.literal{color:#ff7ab2;text-shadow:0.2px 0.2px #000000}.rst-content div[class^="highlight"],.rst-content pre.literal-block{border:1px solid #bd93f9}.rst-content code,.rst-content div[class^="highlight"] pre,.rst-content pre{background:#212133}.highlight .nt{color:#E9729D}.highlight .k,.highlight .kv{color:#6876de}.highlight .c,.highlight .ch,.highlight .cd,.highlight .cpf,.highlight .c1{color:#6272a4}.highlight .o{color:#F18FB0}.highlight .nb{color:#ff7ab2}.highlight .nv{color:#6a5acd}.highlight .s2{color:#FF4971}.highlight .nf,.highlight .fm,.highlight .err{color:#bd93f9;background:none;font-weight:bold}.highlight .cp{color:#6a5acd;font-weight:bold}.highlight .mi{color:#de286e}.highlight .s,.highlight .sa,.highlight .dl{color:#bd93f9}.highlight .cm{font-style:italic;color:#6272a4}.rst-versions{position:unset} </style> <!-- icon --> <link rel="icon" type="image/svg+xml" href="/assets/favicon.ico"> <!-- script --> <script src="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@0.1.8/assets/js/jquery.min.js"></script> <script src="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@0.1.8/assets/js/theme.js"></script> <script src="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@0.1.8/assets/js/anchor.min.js"></script> <script> function feedback(type, message) { console.log(`feedback: https://github.com/rundocs/jekyll-rtd-theme/issues?q=${type}+${message}`); } function highlight() { let text = new URL(location.href).searchParams.get("highlight"); let regexp = new RegExp(text, "im"); if (text) { $(".section").find("*").each(function() { if (this.outerHTML.match(regexp)) { $(this).addClass("highlighted-box"); } }); $(".section").find(".highlighted-box").each(function() { if (($(this).find(".highlighted-box").length > 0)) { $(this).removeClass("highlighted-box"); } }); } } function search(data) { let text = new URL(location.href).searchParams.get("q"); let results = []; let regexp = new RegExp(text, "im"); function slice(content, min, max) { return content.slice(min, max).replace(regexp, (match) => `<span class="highlighted">${match}</span>`); } for (page of data) { let [title, content] = [null, null]; try { if (page.title) { title = page.title.match(regexp); } else { if (page.url == "/") { page.title = "Shadorealm"; } else { page.title = page.url; } } } catch (e) { feedback("search", e.message); } try { if (page.content) { page.content = $("<div/>").html(page.content).text(); content = page.content.match(regexp); } } catch (e) { feedback("search", e.message); } if (title || content) { let result = [`<a href="${page.url}?highlight=${text}">${page.title}</a>`]; if (content) { let [min, max] = [content.index - 100, content.index + 100]; let [prefix, suffix] = ["...", "..."]; if (min < 0) { prefix = ""; min = 0; } if (max > page.content.length) { suffix = ""; max = page.content.length; } result.push(`<p class="context">${prefix}${slice(page.content ,min, max)}${suffix}</p>`); } results.push(`<li>${result.join("")}</li>`); } } if (results.length > 0 && text.length > 0) { $("#search-results ul.search").html(results.join("")); $("#search-results p.search-summary").html("Search finished, found # page(s) matching the search query.".replace("#", results.length)); } else { $("#search-results ul.search").empty(); $("#search-results p.search-summary").html("Your search did not match any documents, please make sure that all words are spelled correctly!"); } $("#rtd-search-form [name='q']").val(text); $("#search-results h2").html("Search Results"); } function reset() { const link = $(".wy-menu-vertical").find(`[href="${location.pathname}"]`); if (link.length > 0) { $(".wy-menu-vertical .current").removeClass("current"); link.addClass("current"); link.closest("li.toctree-l1").parent().addClass("current"); link.closest("li.toctree-l1").addClass("current"); link.closest("li.toctree-l2").addClass("current"); link.closest("li.toctree-l3").addClass("current"); link.closest("li.toctree-l4").addClass("current"); link.closest("li.toctree-l5").addClass("current"); } } function admonition() { const items = { note: "Note", tip: "Tip", warning: "Warning", danger: "Danger" }; for (let item in items) { let content = $(`.language-${item}`).html(); $(`.language-${item}`).replaceWith(`<div class="admonition ${item}"><p class="admonition-title">${items[item]}</p><p>${content}</p></div>`); } } $(document).ready(function() { if (location.pathname == "/search.html") { $.ajax({ dataType: "json", url: "/pages.json" }) .done(search) .fail((xhr, message) => feedback("search", message)); } admonition(); anchors.add(); highlight(); SphinxRtdTheme.Navigation.reset = reset; SphinxRtdTheme.Navigation.enable(true); }); </script> </head> <body class="wy-body-for-nav"> <div class="wy-grid-for-nav"> <!-- SIDE NAV, TOGGLES ON MOBILE --> <nav data-toggle="wy-nav-shift" class="wy-nav-side"> <div class="wy-side-scroll"> <div class="wy-side-nav-search"> <a href="/" class="icon icon-home"> Shadorealm</a> <div role="search"> <form id="rtd-search-form" class="wy-form" action="/search.html" method="get" autocomplete="off"> <input type="text" name="q" placeholder="Search Docs..."> </form> </div> </div> <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation"> <ul> <li class="toctree-l1 "> <a class="reference internal " href="/index.html"> Home </a> </li> <li class="toctree-l1 "> <a class="reference internal " href="/about.html"> About </a> </li> </ul> <a style="padding: 0px" href="/blog"><p class="caption"><span class="caption-text">My Blog</span></p></a><ul> <li class="toctree-l1"> <a class="reference internal" href="/blog/Assembly/">Assembler</a><ul></ul> </li> <li class="toctree-l1"> <a class="reference internal" href="/blog/CLang/">C Language</a><ul> <li class="toctree-l2 "> <a class="reference internal " href="/blog/CLang/Dynamic-Memory-Allocation"> Dynamic Memory Allocation </a> </li></ul> </li> <li class="toctree-l1"> <a class="reference internal" href="/blog/HackTheBox/">Hack the Box</a><ul> <li class="toctree-l2 "> <a class="reference internal " href="/blog/HackTheBox/Cat"> Cat </a> </li></ul> </li> <li class="toctree-l1"> <a class="reference internal" href="/blog/Linux/">Linux</a><ul> <li class="toctree-l2 "> <a class="reference internal " href="/blog/Linux/Hardening-Linux"> Hardening Linux </a> </li></ul> </li> <li class="toctree-l1"> <a class="reference internal" href="/blog/Security/">Security</a><ul> <li class="toctree-l2 "> <a class="reference internal " href="/blog/Security/Exploiting-LXD"> Exploiting LXD </a> </li> <li class="toctree-l2"> <a class="reference internal" href="/blog/Security/MemLabs/">MemLabs</a><ul> <li class="toctree-l3 "> <a class="reference internal " href="/blog/Security/MemLabs/LAB1"> LAB1 : Beginners Luck </a> </li> <li class="toctree-l3 "> <a class="reference internal " href="/blog/Security/MemLabs/LAB2"> LAB2 : A New World </a> </li></ul> </li> <li class="toctree-l2"> <a class="reference internal" href="/blog/Security/Reversing/">Reversing</a><ul> <li class="toctree-l3 "> <a class="reference internal " href="/blog/Security/Reversing/Crackme_CNM"> Crackme - Crackme not Main </a> </li> <li class="toctree-l3 "> <a class="reference internal " href="/blog/Security/Reversing/Crackme_easyAF"> Crackme - easyAF </a> </li> <li class="toctree-l3 "> <a class="reference internal " href="/blog/Security/Reversing/Crackme_gha1"> Crackme - Guild Hall Adventure Ch.1 </a> </li> <li class="toctree-l3 current"> <a class="reference internal current" href="/blog/Security/Reversing/Crackme_gha2"> Crackme - Guild Hall Adventure Ch.2 </a> </li></ul> </li></ul> </li> <li class="toctree-l1"> <a class="reference internal" href="/blog/Vim/">Vim / Neovim</a><ul></ul> </li> <li class="toctree-l1"> <a class="reference internal" href="/blog/Window_Managers/">Window Managers</a><ul></ul> </li></ul> </div></div> </nav> <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"> <!-- MOBILE NAV --> <nav class="wy-nav-top" aria-label="top navigation"> <i data-toggle="wy-nav-top" class="fa fa-bars"></i> <a href="/" class="icon icon-home"> Shadorealm</a> </nav> <div class="wy-nav-content"> <div class="rst-content"> <div role="navigation" aria-label="breadcrumbs navigation"> <ul class="wy-breadcrumbs"> <li> <a href="/" class="icon icon-home"></a><i class="fa fa-angle-double-right"></i> </li> <li> <a href="/blog/">Blog</a><i class="fa fa-angle-double-right"></i> </li> <li> <a href="/blog/Security/">Security</a><i class="fa fa-angle-double-right"></i> </li> <li> <a href="/blog/Security/Reversing/">Reversing</a><i class="fa fa-angle-double-right"></i> </li> <li>Crackme - Guild Hall Adventure Ch.2</li></ul> <hr> </div> <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article"> <div itemprop="articleBody"><div class="section"><h1 id="guild-hall-adventure-ch-2---crackme-writeup">Guild Hall Adventure Ch. 2 - Crackme Writeup</h1> <table class="docutils align-default"> <tbody> <tr> <td>Author: ker2x</td> <td>Level: 2.0</td> <td>Quality: 4.0</td> <td>Platform: Unix/Linux</td> <td>Language: C/C++</td> </tr> </tbody> </table> <p>This crackme has been provided by <a href="https://crackmes.one">crackmes.one</a>.<br /> Get it here: <a href="http://crackmes.one/crackme/5d1a344033c5d410dc4d0c3e">Link</a></p> <h2 id="introduction">Introduction</h2> <p>For all my solutions, I will use radare2: a fantastic terminal user interface reversing tool that amazes me daily on its immense potential (with a few other needed tools mixed in). So when I use a <code class="literal">:&gt; </code> it is a radare2 shell command (from Visual modes you can get to this via the <code class="literal">:</code> key just like in vim). When I use <code class="literal">❱ </code> it is referring to a normal shell command. With that out of the way let's get to the meat of this crackme!</p> <hr /> <h2 id="part-one">Part One</h2> <p>So this is the second part of the crackme story line that <code class="literal">ker2x</code> has made. Let's see how the story builds!</p> <p>Lets open this binary and see what it does without any arguments or anything:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>❱ ./adventure2

    Oooooooooo <span class="o">!</span> Socially approriate greetings <span class="o">!</span>
    Welcome to chapter 2 <span class="o">!</span>
    <span class="nt">--------------------------------------------</span>

   This one is a bit more complex but still <span class="s1">'Easy'</span>
   In order to keep it at this level i<span class="s1">'ll provide just
   a bit of help.

   Each step will be in a self contained function.
   I may have a few helper functions here and there
   but nothing big. I hate difficult easy challenge
   as much as you do.

   The first step is in this main function.

   If you completed the previous chapter, this 1st step should be easy to guess =^_^=

   Once you completed this main step, you can directly skil to step2 using '</span>./adventure2 2<span class="s1">'... probably :D
   You can (try to) cheat and skip the main step entirely but what'</span>s the point <span class="k">then</span> ?
    Good luck <span class="o">!</span> &lt;3

<span class="nt">--</span>
ker2x
:wq


<span class="o">(</span>Press enter to <span class="k">continue</span><span class="o">)</span>

</pre></div></div> <p>Well here is a nice little readme from the author. Catch the <code class="literal">:wq</code> at the end! I guess we have another vim user here! Okay, so what I got out of that is that the <code class="literal">main</code> function holds all of part one, then part two is in a helper function. Also, we are told that there is an argument that allows us to go to the next step to skip all the inputs in this one.</p> <p>Press enter and continue:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre><span class="k">*</span> Previously <span class="k">in </span>Chapter 1 :
<span class="nt">---------------------------</span>

  - After being summoned from another world, you went to the guild hall
  - You met the security guard and didn<span class="s1">'t die
  - You entered the guild hall and didn'</span>t die
  - Then you reached the registration office
    and maybe died a few times. But you<span class="s1">'re a hero
    from another world so it'</span>s fine <span class="o">=</span>^_^<span class="o">=</span>

<span class="k">*</span> Chapter 2, the registration office.
<span class="nt">-------------------------------------</span>

<span class="k">*</span> The receptionist notice you coming directly to her :
<span class="s2">"Heeeelp ! KILL ! KILL ! KILL !"</span>
<span class="o">(</span><span class="nt">-0HP</span><span class="o">)</span>

<span class="o">(</span>Press enter to <span class="k">continue</span><span class="o">)</span>

</pre></div></div> <p>Lets try hitting enter again… well that didn't work.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre><span class="o">(</span>- 1000HP<span class="o">)</span>
Segmentation fault
</pre></div></div><pre class="language-note">By the way, I had to switch to bash (instead of zsh) to get the right output for
the segfault, for some reason zsh really didn't like it and crashes, atleast on
my end.
</pre><p>Seems we need a different input here instead of enter, maybe that is what <code class="literal">ker2x</code> was talkin about with “misguiding” in the README.txt he gave us. I tried an <code class="literal">ltrace</code> but this didn't help or even give any pointers other than that this binary is using <code class="literal">getchar</code> to take input. Let's open this up in radare2 and take a look: Scrolling past all the excess strings and puts/printf's etc, getting to the part we need to look at, there is some manipulation after that second <code class="literal">getchar</code>:</p> <div class="language-nasm highlighter-rouge"><div class="highlight"><pre><span class="err">0</span><span class="nf">x55e90be00af8</span>   <span class="nv">lea</span> <span class="nb">rdi</span><span class="p">,</span> <span class="nv">str._Heeeelp___KILL___KILL___KILL____n__0HP__n</span> <span class="c1">; 0x55e90be01620 ; "\"Heeeelp ! KILL ! KILL ! KILL !\"\n(-0HP)\n" ; const char *s</span>
<span class="err">0</span><span class="nf">x55e90be00aff</span>   <span class="nv">call</span> <span class="nv">sym.imp.puts</span>       <span class="c1">; int puts(const char *s)</span>
<span class="err">0</span><span class="nf">x55e90be00b04</span>   <span class="nv">lea</span> <span class="nb">rdi</span><span class="p">,</span> <span class="nv">str._Press_enter_to_continue_</span> <span class="c1">; 0x55e90be013ff ; "(Press enter to continue)" ; const char *s</span>
<span class="err">0</span><span class="nf">x55e90be00b0b</span>   <span class="nv">call</span> <span class="nv">sym.imp.puts</span>       <span class="c1">; int puts(const char *s)</span>
<span class="err">0</span><span class="nf">x55e90be00b10</span>   <span class="nv">call</span> <span class="nv">sym.imp.getchar</span>    <span class="c1">; int getchar(void)</span>
<span class="err">0</span><span class="nf">x55e90be00b15</span>   <span class="nv">mov</span> <span class="kt">dword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0xb4</span><span class="p">],</span> <span class="nb">eax</span>
<span class="err">0</span><span class="nf">x55e90be00b1b</span>   <span class="nv">mov</span> <span class="nb">rax</span><span class="p">,</span> <span class="kt">qword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0xb0</span><span class="p">]</span>
<span class="err">0</span><span class="nf">x55e90be00b22</span>   <span class="nv">movzx</span> <span class="nb">eax</span><span class="p">,</span> <span class="kt">byte</span> <span class="p">[</span><span class="nb">rax</span><span class="p">]</span>
<span class="err">0</span><span class="nf">x55e90be00b25</span>   <span class="nv">movsx</span> <span class="nb">eax</span><span class="p">,</span> <span class="nb">al</span>
<span class="err">0</span><span class="nf">x55e90be00b28</span>   <span class="nv">add</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">1</span>
<span class="err">0</span><span class="nf">x55e90be00b2b</span>   <span class="nv">cmp</span> <span class="kt">dword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0xb4</span><span class="p">],</span> <span class="nb">eax</span>
<span class="err">0</span><span class="nf">x55e90be00b31</span> <span class="nv">b</span> <span class="nv">je</span> <span class="mh">0x55e90be00b58</span>
</pre></div></div> <p>As you can see by the <code class="literal">b</code> I set a breakpoint at <code class="literal">0x55e90be00b31</code> and will use <code class="literal">dc</code> to get to it (<code class="literal">dc</code>: debug continue - continues program till breakpoint). After continuing to this breakpoint, lets read where we need to check. So we see in the <code class="literal">cmp</code> (line <code class="literal">0x55e90be00b2b</code>) that the variable <code class="literal">rbp-0xb4</code> (which is <code class="literal">var_b4h</code> defined above) gets compared with eax (which we can check):</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>:&gt;  ? eax ~string,hex
hex     0x48
string  <span class="s2">"H"</span>
</pre></div></div> <p>Interesting, it is <code class="literal">'H'</code> after the manipulation. Remember how to see our variables? Yep, <code class="literal">afvd</code>! Let's check <code class="literal">var_b4h</code> and see if our input gets manipulated too.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>:&gt; afvd~var_b4h
var var_b4h <span class="o">=</span> 0x7ffc3983f71c <span class="o">=</span> 10
</pre></div></div><pre class="language-tip">If you noticed the `~` in my commands, this is the built in `GREP` in radare2
believe it or not, in the example above `? eax ~string,hex` the comma is
an OR, so it greps for "string" or "hex".
</pre><p>Okay! So our input does not get manipulated which makes this very easy. If you noticed the <code class="literal">10</code> (0x0a) there, that is the <a href="http://www.asciitable.com/">ASCII</a> value for LF (Line Feed) which is essentially like a newline, and that is what should be expected since we gave the input a newline (Enter Key). Let's try using an <code class="literal">H</code> instead of enter there:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>❱ ./adventure2
<span class="o">(</span>Press enter to <span class="k">continue</span><span class="o">)</span>
H
<span class="s2">"Wait !"</span>

</pre></div></div> <p>Check that out! It worked! Now we have to do the same thing 4 more times haha! Let's look at the next block and set a breakpoint at <code class="literal">0x5585b5600bae</code> and continue to it with <code class="literal">dc</code> (Press any key to test when prompted).</p> <div class="language-nasm highlighter-rouge"><div class="highlight"><pre><span class="err">0</span><span class="nf">x5585b5600b58</span>   <span class="nv">lea</span> <span class="nb">rdi</span><span class="p">,</span> <span class="nv">str._Wait___</span>   <span class="c1">; 0x5585b5601654 ; "\"Wait !\"" ; const char *s</span>
<span class="err">0</span><span class="nf">x5585b5600b5f</span>   <span class="nv">call</span> <span class="nv">sym.imp.puts</span>       <span class="c1">; int puts(const char *s)</span>
<span class="err">0</span><span class="nf">x5585b5600b64</span>   <span class="nv">add</span> <span class="kt">qword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0xb0</span><span class="p">],</span> <span class="mi">1</span>
<span class="err">0</span><span class="nf">x5585b5600b6c</span>   <span class="nv">call</span> <span class="nv">sym.imp.getchar</span>    <span class="c1">; int getchar(void)</span>
<span class="err">0</span><span class="nf">x5585b5600b71</span>   <span class="nv">mov</span> <span class="kt">dword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0xb4</span><span class="p">],</span> <span class="nb">eax</span>
<span class="err">0</span><span class="nf">x5585b5600b77</span>   <span class="nv">call</span> <span class="nv">sym.imp.getchar</span>    <span class="c1">; int getchar(void)</span>
<span class="err">0</span><span class="nf">x5585b5600b7c</span>   <span class="nv">mov</span> <span class="kt">dword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0xb4</span><span class="p">],</span> <span class="nb">eax</span>
<span class="err">0</span><span class="nf">x5585b5600b82</span>   <span class="nv">mov</span> <span class="nb">rax</span><span class="p">,</span> <span class="kt">qword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0xb0</span><span class="p">]</span>
<span class="c1">; DATA XREF from sym.step2 @ 0x5585b5600e29</span>
<span class="err">0</span><span class="nf">x5585b5600b89</span>   <span class="nv">add</span> <span class="nb">rax</span><span class="p">,</span> <span class="mi">1</span>
<span class="err">0</span><span class="nf">x5585b5600b8d</span>   <span class="nv">mov</span> <span class="kt">qword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0x98</span><span class="p">],</span> <span class="nb">rax</span>
<span class="err">0</span><span class="nf">x5585b5600b94</span>   <span class="nv">mov</span> <span class="nb">rax</span><span class="p">,</span> <span class="kt">qword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0x98</span><span class="p">]</span>
<span class="err">0</span><span class="nf">x5585b5600b9b</span>   <span class="nv">sub</span> <span class="nb">rax</span><span class="p">,</span> <span class="mi">1</span>
<span class="err">0</span><span class="nf">x5585b5600b9f</span>   <span class="nv">movzx</span> <span class="nb">eax</span><span class="p">,</span> <span class="kt">byte</span> <span class="p">[</span><span class="nb">rax</span><span class="p">]</span>
<span class="err">0</span><span class="nf">x5585b5600ba2</span>   <span class="nv">movsx</span> <span class="nb">eax</span><span class="p">,</span> <span class="nb">al</span>
<span class="err">0</span><span class="nf">x5585b5600ba5</span>   <span class="nv">add</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">1</span>
<span class="err">0</span><span class="nf">x5585b5600ba8</span>   <span class="nv">cmp</span> <span class="kt">dword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0xb4</span><span class="p">],</span> <span class="nb">eax</span>
<span class="c1">;-- rip:</span>
<span class="err">0</span><span class="nf">x5585b5600bae</span> <span class="nv">b</span> <span class="nv">je</span> <span class="mh">0x5585b5600bd5</span>
</pre></div></div> <p>Again <code class="literal">eax</code> is being compared with <code class="literal">var_b4h</code> (our input). Now that we hit the breakpoint we can check what <code class="literal">eax</code> is:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>:&gt; ? eax ~string,hex
hex     0x65
string  <span class="s2">"e"</span>
</pre></div></div> <p>Well this is obviously spelling out a word, let's try <code class="literal">e</code> after doing <code class="literal">H</code> in a separate instance:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>❱ ./adventure2
...
<span class="o">(</span>Press enter to <span class="k">continue</span><span class="o">)</span>
H
<span class="s2">"Wait !"</span>
e
- It<span class="s1">'s trying to say something ...
- it'</span>s a he ? Kawaiiii~~~~ <span class="o">=</span>^_^<span class="o">=</span>

<span class="o">(</span>- 3000HP<span class="o">)</span>
Segmentation fault
</pre></div></div> <p>Okay, I think you guys can figure the rest out on your own for the next 3 letters, either the debugging route, or just guessing…</p> <h5 id="tip">Tip</h5> <p>To restart debugging in radare2, you can use the <code class="literal">ood</code> or <code class="literal">doo</code> commands to “re-open for debugging” essentially. These can also take flags as arguments, e.g: <code class="literal">ood test</code> would re-open the program passing in the <code class="literal">test</code> argument.</p> <h3 id="solution">Solution</h3> <p>I hope you could find the next three letters on your own but this wouldn't be a valid solution without having them here. Try doing it on your own though and see if you can get the same ones I did!</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre><span class="o">(</span>Press enter to <span class="k">continue</span><span class="o">)</span>
H
<span class="s2">"Wait !"</span>
e
- It<span class="s1">'s trying to say something ...
- it'</span>s a he ? Kawaiiii~~~~ <span class="o">=</span>^_^<span class="o">=</span>
l
<span class="s2">"Yes ! you can do it !!"</span>
l
- huh ? you come from the deep underground ?
- Should we report it to the church ? Followers of Hades are punished by the holy church ... or so i<span class="s1">'m told
- Not that we'</span>re followers, we<span class="s1">'re the free guild... free as in free beer ! Or
was it free speech ?
- Mmmm... what do we do ? what do we do ?
o
"Oooooooooo ! Socially approriate greetings !
"So you'</span>re not a monster after all <span class="o">!</span> Sorry sorry <span class="o">!</span><span class="s2">"
(Press enter to continue... probably...)

</span></pre></div></div> <p>Yep it is <code class="literal">Hello</code>! The little story lines to go along with it as you figure out the letters is pretty hilarious, not gonna lie lol!</p> <p>After that hit enter two times (read the dissassembly, there are no checks for those) and you are now on the second step!!</p> <h2 id="part-two">Part Two</h2> <p>So remember earlier we were told that the first step all happens really in the <code class="literal">main</code> function? Well now we are in <code class="literal">sym.step2</code> function so on to step 2!</p> <h3 id="getting-the-shortcut-key">Getting the Shortcut Key</h3> <p>First, there is a little part in the beginning of dissassembly that checks for a valid argument. If you get it completely wrong:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>❱ ./adventure2 <span class="nb">test
</span>NOPE!
Segmentation fault
</pre></div></div> <p>The logic is a little tricky so I provided some pictures of the flow to clear it up:</p> <p><img src="https://i.imgur.com/0RYRzMM.png" alt="Pic1" /></p> <p><img src="https://i.imgur.com/oUamSZP.png" alt="Pic2" /></p> <p>As you can see, <code class="literal">argc</code> gets checked at the end of the first block. If it is not <code class="literal">1</code> then we continue to the left, else it will continue down to step 1 essentially. Okay, that is easy, lets just give it an argument: that will make <code class="literal">argc = 2</code>. If we set a breakpoint at <code class="literal">0x55d6310008fb</code>, you will see that this works. This breakpoint will help for the second block here as well, so follow along. There is a lot of manipulation in this second block so lets just check the variables by debugging at the breakpoint we set: (I'm using <code class="literal">ood 2</code> as the argument because remember the hint when initially opening of the binary ;))</p> <div class="language-nasm highlighter-rouge"><div class="highlight"><pre><span class="err">:&gt;</span> <span class="nf">ood</span> <span class="mi">2</span>
<span class="err">:&gt;</span> <span class="nf">dc</span>
<span class="nf">hit</span> <span class="nv">breakpoint</span> <span class="nv">at</span><span class="p">:</span> <span class="mh">0x558893a008fb</span>
<span class="err">:&gt;</span> <span class="nf">pdb</span>
<span class="err">0</span><span class="nf">x558893a008c2</span>   <span class="nv">mov</span> <span class="nb">rax</span><span class="p">,</span> <span class="kt">qword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0xd0</span><span class="p">]</span>
<span class="err">0</span><span class="nf">x558893a008c9</span>   <span class="nv">add</span> <span class="nb">rax</span><span class="p">,</span> <span class="mi">8</span>
<span class="err">0</span><span class="nf">x558893a008cd</span>   <span class="nv">mov</span> <span class="nb">rax</span><span class="p">,</span> <span class="kt">qword</span> <span class="p">[</span><span class="nb">rax</span><span class="p">]</span>
<span class="err">0</span><span class="nf">x558893a008d0</span>   <span class="nv">add</span> <span class="nb">rax</span><span class="p">,</span> <span class="mi">1</span>
<span class="err">0</span><span class="nf">x558893a008d4</span>   <span class="nv">mov</span> <span class="nb">rdi</span><span class="p">,</span> <span class="nb">rax</span>            <span class="c1">; const char *s</span>
<span class="err">0</span><span class="nf">x558893a008d7</span>   <span class="nv">call</span> <span class="nv">sym.imp.strlen</span>     <span class="c1">; size_t strlen(const char *s)</span>
<span class="err">0</span><span class="nf">x558893a008dc</span>   <span class="nv">mov</span> <span class="nb">rdx</span><span class="p">,</span> <span class="nb">rax</span>
<span class="err">0</span><span class="nf">x558893a008df</span>   <span class="nv">mov</span> <span class="nb">rax</span><span class="p">,</span> <span class="kt">qword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0xd0</span><span class="p">]</span>
<span class="err">0</span><span class="nf">x558893a008e6</span>   <span class="nv">add</span> <span class="nb">rax</span><span class="p">,</span> <span class="mi">8</span>
<span class="err">0</span><span class="nf">x558893a008ea</span>   <span class="nv">mov</span> <span class="nb">rax</span><span class="p">,</span> <span class="kt">qword</span> <span class="p">[</span><span class="nb">rax</span><span class="p">]</span>
<span class="err">0</span><span class="nf">x558893a008ed</span>   <span class="nv">movzx</span> <span class="nb">eax</span><span class="p">,</span> <span class="kt">byte</span> <span class="p">[</span><span class="nb">rax</span><span class="p">]</span>
<span class="err">0</span><span class="nf">x558893a008f0</span>   <span class="nv">movsx</span> <span class="nb">eax</span><span class="p">,</span> <span class="nb">al</span>
<span class="err">0</span><span class="nf">x558893a008f3</span>   <span class="nv">sub</span> <span class="nb">eax</span><span class="p">,</span> <span class="mh">0x30</span>           <span class="c1">; 48</span>
<span class="err">0</span><span class="nf">x558893a008f6</span>   <span class="nv">cdqe</span>
<span class="err">0</span><span class="nf">x558893a008f8</span>   <span class="nv">cmp</span> <span class="nb">rdx</span><span class="p">,</span> <span class="nb">rax</span>
<span class="c1">;-- rip:</span>
<span class="err">0</span><span class="nf">x558893a008fb</span> <span class="nv">b</span> <span class="nv">je</span> <span class="mh">0x558893a00909</span>
<span class="err">:&gt;</span> <span class="nf">dr</span> <span class="o">~</span><span class="nb">rax</span><span class="p">,</span><span class="nb">rdx</span>
<span class="nf">rax</span> <span class="err">=</span> <span class="mh">0x00000002</span>
<span class="nf">rdx</span> <span class="err">=</span> <span class="mh">0x00000000</span>
</pre></div></div> <p>So check it out, there is a <code class="literal">strlen</code> that throws the length of our passed in arg to <code class="literal">rdx</code> which gets compared at the end of the block with our <code class="literal">rax</code>. So since our <code class="literal">eax</code> is <code class="literal">2</code> and our <code class="literal">rdx</code> is <code class="literal">0</code>, lets try to make rdx 3 characters instead.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>:&gt; ood 200
:&gt; dc
...
</pre></div></div> <p>Hit step2? Good, it should have worked. Anything that starts with a too, is 3 characters (even letters work), and not <code class="literal">222</code> will work to skip to step2!</p> <h3 id="step-2">Step 2</h3> <p>Let's start playing with step2 now! Remember it is in a different function, so in radare2 if you want to seek to it use: <code class="literal">s sym.step2</code> or just to view it: <code class="literal">pdf @ sym.step2</code> | <code class="literal">VV @ sym.step2</code>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>❱ ./adventure2 200

   Welcome to step 2 of chapter 2 <span class="o">!</span>
   If you see this message because you randomly played with arguments
   but didn<span class="s1">'t complete the 1st step, please go back and run the program without arguments
   Unless you'</span>re cheating ? meh... whatever...

   BUT <span class="o">!!</span> If you completed the 1st step : CONGRATULATION <span class="se">\o</span>/ <span class="o">!!</span>

   ...
   Damn... I painstakingly coded this whole <span class="o">[</span>go directly to step 2 stuff]
   So now i guess i really have to code a step 2
   Don<span class="s1">'t want to do it... (Just press enter or something and we'</span>ll improvise somehow<span class="o">)</span>

<span class="o">(</span>pressed enter<span class="o">)</span>

   By the way, what argument did you use to come here ? 2
 2 ? good good... please remember it <span class="o">!</span>

  <span class="o">(</span>Press enter or whatever, <span class="nb">who </span>care ?<span class="o">)</span>

</pre></div></div> <p>So at this point we get more dialog, we successfully got to step 2 without cheating! Can safely hit enter the first time, for the second input it is just a <code class="literal">getchar</code> so it will only take one character but it doesn't matter too much, it will overflow to the other inputs though if you give it too much. Hit enter again after you put a number in:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>- So you want to register to the guild ? Math question <span class="k">then</span> <span class="o">!</span>
- it<span class="s1">'s totally not because i'</span>m lazy or anything <span class="o">!</span> Bakkaaaa~ <span class="o">!</span>
what<span class="s1">'s 2 + 3 * 5 ? 
</span></pre></div></div> <p>Oh we get a math question! Looks easy enough! <code class="literal">17</code> should be the right answer here unless im just stupid lol…</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>BWAHAHAHAHA BAKAAAAAAAA <span class="o">!!!</span> 0x44ab8d14 is super totally wrooong <span class="o">!</span>
Segmentation fault <span class="o">(</span>core dumped<span class="o">)</span>

...

Segmentation fault
</pre></div></div> <p>Am I that stupid, he is calling be a BAKA (idiot in Japanese lol)? No haha obviously not, that math question isn't real and is just to throw us off from the disassembly. Let's set a breakpoint at <code class="literal">0x561b3d400f17</code> (the jump line after the compare) and see what the values being compared are:</p> <div class="language-nasm highlighter-rouge"><div class="highlight"><pre><span class="err">:&gt;</span> <span class="kd">db</span> <span class="mh">0x561b3d400f17</span>
<span class="err">:&gt;</span> <span class="nf">dc</span>
<span class="err">-</span> <span class="nf">So</span> <span class="nv">you</span> <span class="nv">want</span> <span class="nv">to</span> <span class="nv">register</span> <span class="nv">to</span> <span class="nv">the</span> <span class="nv">guild</span> <span class="nv">?</span> <span class="nv">Math</span> <span class="nv">question</span> <span class="nv">then</span> <span class="err">!</span>
<span class="err">-</span> <span class="nf">it</span><span class="err">'</span><span class="nv">s</span> <span class="nv">totally</span> <span class="nv">not</span> <span class="nv">because</span> <span class="nv">i</span><span class="err">'</span><span class="nv">m</span> <span class="nv">lazy</span> <span class="nv">or</span> <span class="nv">anything</span> <span class="err">!</span> <span class="nv">Bakkaaaa~</span> <span class="err">!</span>
<span class="nf">what</span><span class="err">'</span><span class="nv">s</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">5</span> <span class="nv">?</span> <span class="mi">17</span>
<span class="nf">hit</span> <span class="nv">breakpoint</span> <span class="nv">at</span><span class="p">:</span> <span class="mh">0x561b3d400f17</span>
<span class="err">:&gt;</span> <span class="nf">pdb</span> <span class="o">~</span><span class="nv">cmp</span><span class="p">,</span><span class="nv">je</span>
<span class="err">│</span>           <span class="err">0</span><span class="nf">x561b3d400f14</span>      <span class="mi">3945</span><span class="nv">ec</span>         <span class="nv">cmp</span> <span class="kt">dword</span> <span class="p">[</span><span class="nb">rbp</span> <span class="o">-</span> <span class="mh">0x14</span><span class="p">],</span> <span class="nb">eax</span>
<span class="err">│</span>       <span class="err">╭─&lt;</span> <span class="err">0</span><span class="nf">x561b3d400f17</span> <span class="nv">b</span>    <span class="mi">7445</span>           <span class="nv">je</span> <span class="mh">0x561b3d400f5e</span>
</pre></div></div> <p>Now, I wouldn't have caught this so easily my first time through without my handy dandy visual panel layout in radare2. You can do anything with this panel mode and nothing makes me happier than something that lets me make it my own. This made it super simple and efficient for me to check the variables and everything else.</p> <p><img src="https://i.imgur.com/UVXhAC1.png" alt="panels" /></p> <p>Take a look at <code class="literal">var_14h</code> though! That is what is being compared with our input… <code class="literal">65</code>. Let's try it!</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre>what<span class="s1">'s 2 + 3 * 5 ? 65
BWAHAHAHAHA BAKAAAAAAAA !!! 0xedea1884 is super totally wrooong !
Segmentation fault (core dumped)

...

ho damn, that'</span>s right...
WHY ?

To be continued... <span class="o">(</span>you really succeded but i<span class="s1">'ll kill you anyway. don'</span>t worry, you<span class="s1">'ll be fine)

Segmentation fault
</span></pre></div></div> <p>Would you look at that! We beat step two! The first “Segmentation fault (core dumped)” is actually a made-up function that prints that to throw us off, the second Segfault though is on purpose and is a real segfault that happens due to calling <code class="literal">rdx</code> I believe. It seems that rdx may hold a function pointer that isn't allocated or something of the sort, but don't quote me on it! Either way it was a pretty cool way to misguide the challenger. Didn't stump us though!</p> <h2 id="recap">Recap</h2> <h3 id="step-1">Step 1</h3> <p>We first are prompted with a readme and to hit enter. Hit it once, but after that we had to figure out the right input. Remember what it was? Yep! <code class="literal">Hello</code> one letter at a time which got us to step 2 (after 2 more enters).</p> <h3 id="step-2-1">Step 2</h3> <p>First, we cracked the shortcut key to skip step1 to test more efficiently in step2. The key is anything that starts with a <code class="literal">2</code> and is 3 characters long, <code class="literal">200</code> works perfect.</p> <p>Rerun the binary with <code class="literal">200</code> or the key you want as an argument.</p> <p>Next, when prompted we hit enter, then put in a number that we used to get to step 2. Just throw <code class="literal">2</code> in there, it doesn't matter much and hit enter. We then are prompted with a math question that is just to misguide so we dug into the disassembly and look closely at the compare which is comparing our input to <code class="literal">65</code>. Try that for the input and we are golden after a few more enter presses!</p> <hr /> <h2 id="closing">Closing</h2> <p>Hope you enjoyed this writeup! This one was pretty long, atleast this blog post is. Can just skip to <a href="#recap">recap</a> to get past all the explanation and right to the solution.</p> <p>This second part of the Guild Hall Adventure story has been a blast though! Really odd not going to lie but still has been fun! Hope you guys enjoyed it like I did!</p> <p>Thanks for reading and have a blessed day! Shado out.</p> </div> </div> </div> <footer><div class="rst-footer-buttons" role="navigation" aria-label="footer navigation"><a href="/blog/Security/Reversing/Crackme_gha1" class="btn btn-neutral float-left" title="Crackme - Guild Hall Adventure Ch.1" accesskey="p" rel="prev"> <span class="fa fa-arrow-circle-left"></span> Previous</a></div><hr><div role="contentinfo" class="copyright"> <p> <i class="fa fa-copyright"></i> Copyright 2020-2021, Shadorain </p> </div><div role="contentinfo" class="copyright-rtd"> <a href="https://github.com/rundocs/jekyll-rtd-theme">jekyll-rtd-theme</a> </div> </footer> </div> </div> </section> </div><div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions"> <span class="rst-current-version" data-toggle="rst-current-version"> <span class="fa fa-book"> Shadorealm</span> <span class="fa fa-caret-down"></span> </span> <div class="rst-other-versions"><dl> <dt>GitHub</dt> <dd><a href="#"><i class="fa fa-github"></i> Homepage</a></dd> <dd><a href="#"><i class="fa fa-download"></i> Download</a></dd> <dd><a href="#"><i class="fa fa-question-circle-o"></i> Issues</a></dd> </dl> <dl> <dt>Gems</dt> <dd><a href="https://rubygems.org/gems/jekyll-coffeescript"><i class="fa fa-cog"></i> jekyll-coffeescript</a></dd> <dd><a href="https://rubygems.org/gems/jekyll-commonmark-ghpages"><i class="fa fa-cog"></i> jekyll-commonmark-ghpages</a></dd> <dd><a href="https://rubygems.org/gems/jekyll-gist"><i class="fa fa-cog"></i> jekyll-gist</a></dd> <dd><a href="https://rubygems.org/gems/jekyll-github-metadata"><i class="fa fa-cog"></i> jekyll-github-metadata</a></dd> <dd><a href="https://rubygems.org/gems/jekyll-paginate"><i class="fa fa-cog"></i> jekyll-paginate</a></dd> <dd><a href="https://rubygems.org/gems/jekyll-relative-links"><i class="fa fa-cog"></i> jekyll-relative-links</a></dd> <dd><a href="https://rubygems.org/gems/jekyll-optional-front-matter"><i class="fa fa-cog"></i> jekyll-optional-front-matter</a></dd> <dd><a href="https://rubygems.org/gems/jekyll-readme-index"><i class="fa fa-cog"></i> jekyll-readme-index</a></dd> <dd><a href="https://rubygems.org/gems/jekyll-default-layout"><i class="fa fa-cog"></i> jekyll-default-layout</a></dd> <dd><a href="https://rubygems.org/gems/jekyll-titles-from-headings"><i class="fa fa-cog"></i> jekyll-titles-from-headings</a></dd> </dl> <dl> <dt>Statistics</dt> <dd> <a href="https://github.com/rundocs/analytics" target="_blank"> Total visits: <span id="counter"></span> <i class="fa fa-eye"></i> </a> </dd> </dl> <script> $(document).ready(function() { $.getJSON("https://rundocs-analytics.glitch.me/analytics?host=" + location.host, function(data) { $("#counter").html(data.count); }); }); </script> <hr> <small> <span> Built with <a href="https://jekyllrb.com/">Jekyll</a> using the <a href="https://github.com/rundocs/jekyll-rtd-theme">jekyll-rtd-theme</a> (MIT) </span> </small> </div> </div> <!-- analytics --></body> </html>